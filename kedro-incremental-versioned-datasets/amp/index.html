<!DOCTYPE html>
<html ‚ö° lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width" name="viewport"/>
<link href="/8bitcc.ico" rel="icon" type="image/png"/>
<meta content="$ilp.uphold.com/MGN2ni2YMXaQ" name="monetization" property="monetization"/>
<link href="8bitcc_48x48.png" rel="apple-touch-icon" sizes="48x48"/>
<link href="8bitcc_72x72.png" rel="apple-touch-icon" sizes="72x72"/>
<link href="8bitcc_96x96.png" rel="apple-touch-icon" sizes="96x96"/>
<link href="8bitcc_144x144.png" rel="apple-touch-icon" sizes="144x144"/>
<link href="8bitcc_192x192.png" rel="apple-touch-icon" sizes="192x192"/>
<link href="8bitcc_256x256.png" rel="apple-touch-icon" sizes="256x256"/>
<link href="8bitcc_384x384.png" rel="apple-touch-icon" sizes="384x384"/>
<link href="8bitcc_512x512.png" rel="apple-touch-icon" sizes="512x512"/>
<title>Incremental Versioned Datasets in Kedro</title>

<style amp-boilerplate="">body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate="">body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>
<style amp-custom="">
        h1{font-weight:700}h1,h2,h3,h4,h5,h6{font-family:"Space Mono",monospace}h1{font-size:2.5em;font-family:"Space Mono",monospace;color:#6a65ca;color:#ff66c4}h2{font-size:1.63rem;color:#d68eba}h3{font-family:"Space Mono",monospace}p{font-family:"Space Mono",monospace;color:rgba(255,255,255,.6);font-size:21px;font-style:normal;font-variant:normal;font-weight:400;line-height:1.5}@media only screen and (max-width:700px){p{font-size:18px}}@media only screen and (max-width:600px){p{font-size:16px}}@media only screen and (max-width:500px){p{font-size:14px}}@media only screen and (max-width:400px){p{font-size:12px}}blockquote{font-family:"Space Mono",monospace}code{font-family:"Space Mono",monospace}pre{font-family:"Segoe UI",Frutiger,"Frutiger Linotype","Dejavu Sans","Helvetica Neue",Arial,sans-serif;font-family:"Space Mono",monospace;font-family:"Space Mono",monospace}a{font-family:"Space Mono",monospace;color:#6f6bae;text-decoration-color:goldenrod}*{box-sizing:border-box}*{font-family:"SF Mono",Monaco,Inconsolata,"Fira Mono","Droid Sans Mono","Source Code Pro",monospace}article,body,div,footer,header,hgroup,html,nav,section{position:relative;display:flex;align-items:center;flex-direction:column;flex-shrink:0}li,p,ul{margin:0;padding:0}p{margin-bottom:1rem}body,html{min-height:100vh;max-width:100%;width:100%;margin:0;padding:2rem;overflow-x:hidden;color:#fafafa;display:flex;padding:0;background-size:800px;min-height:100vh;background:#282c34;background:linear-gradient(81deg,#282c34 0,#3a2e3d 100%)}section{margin-bottom:5rem}h1{color:#ff66c4}ul.archive-list{box-shadow:0 0 2rem rgba(0,0,0,.3),-8rem -6rem 8rem -6rem rgba(253,221,88,.2),4rem 0 8rem rgba(88,82,185,.3),0 0 2rem -1.6rem rgba(255,215,70,.8);margin:0;padding:0;list-style-type:none;margin-top:1rem}li.post{margin:0;width:100%;list-style-type:none;border-width:1px;border-style:solid;border-image:linear-gradient(to right,#ff66c4,rgba(255,102,196,.2)) 1 0 0 0}li.post:nth-child(2n-1){background-color:rgba(255,255,255,.01);background-image:linear-gradient(22deg,rgba(255,255,255,0),rgba(255,255,255,.03))}li.post:nth-child(2n){background-color:rgba(0,0,0,.02);background-image:linear-gradient(22deg,rgba(0,0,0,0),rgba(0,0,0,.03))}li.post a{color:#fafafa;text-decoration:none}li.post h2,li.post p{max-width:800px;width:calc(100vw - 100px)}li.post h2,li.post p{margin-left:2rem;margin-right:2rem}li.post a:focus-visible h2,li.post:hover h2{color:#ff66c4}p{color:#d3d3d3}li.post a:focus-visible p,li.post:hover p{color:#fafafa}nav{padding:1rem 0;align-items:flex-end;max-width:1000px;width:100%}nav ul{list-style-type:none;display:flex}nav ul li{margin:0 .4rem}nav ul li a{text-align:center;color:#dcdcdc;text-decoration:none;padding:.5rem;margin-left:.1rem;margin-right:.1rem;align-items:flex-end}nav ul li a:focus-visible,nav ul li:hover a,ul.archive-tags li a:focus-visible,ul.archive-tags li:hover a{color:#ff66c4}ul.archive-tags{display:flex;justify-content:center;list-style-type:none;color:#dcdcdc;border-bottom:1px solid rgba(255,255,255,.1);margin-bottom:2rem;width:100%}ul.archive-tags li{padding:.2rem 1rem}ul.archive-tags li a{text-decoration:none;color:#fafafa}.social{display:flex}.social li{list-style-type:None}.social a{color:#daa520;padding:1rem .2rem}#cover-wrapper{z-index:2;width:100%;min-height:min(420px,100vw / 2.38)}#cover-wrapper img{width:calc(100% + 2rem);margin:-2rem}#title-wrapper{display:flex;justify-content:flex-end;align-items:flex-end;width:calc(100% + 2rem);left:-1rem;padding:8rem 1rem 0;margin-top:-8rem;margin-bottom:2.2rem;background:linear-gradient(149deg,#282c34 0,rgba(58,46,61,0) 100%);border-bottom:1px solid #daa520}#title-wrapper h1{margin-top:8rem;margin-bottom:0;word-break:break-all}#title-wrapper p{text-align:right;padding-left:0;margin-bottom:0;margin-top:0}#title-wrapper a{color:#daa520;text-decoration:none}#title-wrapper .h-card .content{display:flex;flex-direction:column;align-items:flex-end;margin:1rem 0}.p-note,.post-date{color:rgba(255,255,255,.2)}#title-wrapper a:focus-visible,#title-wrapper a:hover{color:#ff66c4}article.blog-post,div#post-body{display:block}article.blog-post .toc a{padding:.5rem}article.blog-post .toc li{margin:1rem}article.blog-post .toc ul{list-style-type:none;border:none;padding:0;margin:0 0 .5rem}article.blog-post div.toc{margin-bottom:1rem}article.blog-post div.toc:after{content:'';display:block;width:50%;border-bottom:1px solid #daa520}h2.toc{margin-bottom:1rem;text-align:center;color:rgba(255,255,255,.8)}.toc li{margin:1rem}.toc a{color:rgba(255,255,255,.5)}.toc a:focus-visible,.toc a:hover{color:#ff66c4}article.blog-post li>code,article.blog-post p>code{background:rgba(255,20,147,.075);padding:0 .2rem}article.blog-post{overflow:hidden;background:rgba(51,0,38,.13);background:hsla(234,33%,15%,.66);display:block;margin:.2rem;width:min(95vw,1000px);position:relative;margin:2rem 0;padding:1rem;padding-bottom:5rem;border-radius:2px;box-shadow:.2rem .2rem 1rem rgba(0,0,0,.2);flex-direction:column;align-items:flex-start;color:#f5f5f5}@media (max-width:650px){article.blog-post{width:100vw;width:min(100vw,1000px)}}@media (max-width:1200px){article.blog-post h1{font-size:2.5rem;padding:1rem}}@media (max-width:1200px){article.blog-post h2{padding-left:1rem}}@media (max-width:1200px){article.blog-post h3{padding-left:1.4rem}}@media (max-width:1200px){article.blog-post h4,article.blog-post h5,article.blog-post h6{padding-left:1.6rem}}@media (max-width:1200px){article.blog-post{margin:0;padding:0;margin:0}}article.blog-post p{margin:2rem .8rem}@media (max-width:1200px){article.blog-post p{margin:2rem .8rem}article.blog-post ol,article.blog-post ul{padding:1.2rem}}article.blog-post pre{margin-bottom:1rem;align-self:flex-start;max-width:calc(100vw - 20px);padding:10px;overflow-x:auto}article.blog-post .highlight{background:#282c34;padding:1rem;margin:0 -1rem;width:calc(100% + 2rem)}article.blog-post a{color:#6f6bae;text-decoration-color:#330026;text-decoration-color:goldenrod}@media (max-width:1200px){p>img{left:-.8rem}}p>img{position:relative;box-shadow:.2rem .2rem 1rem rgba(51,0,38,.4);max-width:1000px;width:95vw;align-self:center;justify-self:center;align-items:center;justify-items:center;margin:auto;left:-1.6rem}.center-img>img{max-width:600px;margin:.5rem}.center-img{display:flex;justify-content:center}strong{color:#d68fbb;display:inline-block;transform:rotate(-2deg)}em{color:#6f6bae;display:inline-block;transform:rotate(.2deg);background:rgba(255,255,255,.04);padding:.1rem .8rem}h2{margin-top:5rem}article.blog-post ul{border-left:1px solid #ff66c4;padding:.5rem 0 .025rem 3rem;margin:2rem}blockquote{color:#777;background:rgba(255,20,147,.05);border-left:2px solid #daa520;font-size:1rem;padding:1rem 0 1rem .5rem;margin:2rem 0}hr{border:none;border-top:1px solid #daa520;margin:5rem auto;background:0 0;width:min(600px,80%)}h1{margin-top:5rem}.tweet{display:flex;justify-content:flex-end;margin:1rem 0}.tweet a{display:inline-block;border-radius:5px;padding:.5rem 1rem;background:#645fc4;color:#fedd58;text-decoration:none;vertical-align:center}.share{max-width:800px;margin:.8rem auto;padding:1rem 2rem;display:flex;align-items:center;border:1px solid #d68fbb;background-color:rgba(214,143,187,.1);border-radius:5px}.share a{padding:.2rem .5rem}.share p{margin:0;padding:0;padding-right:.2rem}.share ul li{margin:0;padding:0}.shrare ul{display:flex;list-style-type:none;margin:0;padding:0;border:none;font-size:1.3rem}.post-body hr{border-top:2px solid rgba(218,165,32,.2);margin:3rem 40%}.h-card{border-radius:5px;display:flex;align-items:center;justify-content:flex-end}.h-card img{width:50px;border-radius:50%;margin:.2rem;display:none}.h-card ul.social{list-style-type:none;border:none;margin:0;padding:0}.social{display:flex}.social li{list-style-type:None}.social a{color:#daa520;padding:1rem .2rem}.h-card li{margin:0;padding:0}.toc{width:min(90vw,600px);margin:auto;position:initial;font-size:.8rem;line-height:1.1rem}.toc li{padding:0;margin:0}.toc li.H1,.toc li.H2{padding-top:.8rem}.toc li.H3{padding-left:.5rem}.toc li.H4{padding-left:1rem}.toc li.H5{padding-left:1.25rem}.toc li.H6{padding-left:1.5rem}@media (min-width:1500px){.toc{display:none}}.twitter-tweet{margin:10px auto}.onelinelink-wrapper{max-width:100vw}a.onelinelink{position:relative;left:2rem;background:#262236;margin:-6rem auto 1rem;border:2px solid rgba(255,50,50,.1);max-width:300px;border-radius:15px/45px;display:block;flex-direction:row}@media (max-width:350px){a.onelinelink{left:0;margin-left:.4rem;margin-right:.4rem}}@media (min-width:800px){a.onelinelink{max-width:600px;margin:auto}}@media (min-width:900px){a.onelinelink{max-width:700px}}@media (min-width:1000px){a.onelinelink{max-width:800px}}a.onelinelink{position:relative;z-index:2;margin:4rem;overflow:hidden;display:flex;border:2px solid rgba(255,50,50,.1);background:rgba(255,50,50,.015);background:#262236;text-decoration:none;border-radius:8px;max-height:126px}@media (max-width:800px){a.onelinelink{flex-direction:column;max-height:800px;max-width:300px;margin:4rem auto}}a.onelinelink h2{top:-1.2rem;postition:relative;margin:0;padding:0;font-size:.8rem;font-weight:400}a.onelinelink .right{width:calc(100% - 250px - 4rem);padding:5px 15px}@media (max-width:800px){a.onelinelink .right{width:auto}}a.onelinelink .description{font-size:1rem;line-height:1.2rem;height:calc(100% - 31px - 1rem);padding:0;padding-bottom:1rem;padding-top:.1rem;margin:0}a.onelinelink .url{padding-right:30px;color:rgba(255,255,255,.1);text-align:right;position:relative;z-index:2;background:#262236}a.onelinelink img{max-width:300px;max-height:126px;padding:0;margin:0;border-radius:8px 0 0 8px}a.onelinelink .read-more{font-size:.6rem;color:rgba(255,255,255,.08)}table{border-collapse:collapse;margin:auto}table,td,th{border:1px solid rgba(255,255,255,.4);min-width:5rem;padding:.2rem}.speed-control{display:flex;flex-direction:row;justify-content:center;margin-top:-.2rem;padding:1rem 0 .5rem;background:rgba(0,0,0,.3)}.speed-control button{margin:.4;transition:all .2s;border:.1rem solid #d3d3d3;color:#d3d3d3;background:0 0;text-align:center;padding:.35rem 1.2rem;margin:.1rem .5rem;border-radius:.12rem}.speed-control button:hover{color:#000;background:#d3d3d3}body::-webkit-scrollbar{width:1rem}@media (max-width:1000px){body::-webkit-scrollbar{width:.5rem}}@media (max-width:425px){body::-webkit-scrollbar{width:.25rem}}html{scroll-behavior:smooth;scrollbar-width:thin;scrollbar-color:#5651B7}body::-webkit-scrollbar-track{background:#392e3d}body::-webkit-scrollbar-thumb{background-color:#5651b7;border-radius:.25rem;background:#706bd0;background:linear-gradient(180deg,#706bd0 0,#5651b7 100%);border:1px solid rgba(86j,81,183,.5)}
    </style>
<meta content="article" name="og:type" property="og:type"/><meta content="Waylon Walker" name="og:author" property="og:author"/><meta content="Waylon Walker" name="og:site_name" property="og:site_name"/><meta content="#322D39" name="theme-color"/><meta content="Waylon Walker" name="og:author" property="og:author"/><meta content="waylon@waylonwalaker.com" name="og:author_email" property="og:author_email"/><meta content="website" name="og:type" property="og:type"/><meta content="Kedro versioned datasets can be mixed with incremental and partitioned datasets https://waylonwalker.com/what-is-kedro/ üëÜ Unsure what kedro is?  Check out this " name="description" property="description"/><meta content="Kedro versioned datasets can be mixed with incremental and partitioned datasets https://waylonwalker.com/what-is-kedro/ üëÜ Unsure what kedro is?  Check out this " name="og:description" property="og:description"/><meta content="Kedro versioned datasets can be mixed with incremental and partitioned datasets https://waylonwalker.com/what-is-kedro/ üëÜ Unsure what kedro is?  Check out this " name="twitter:description" property="twitter:description"/><meta content="Incremental Versioned Datasets in Kedro | Waylon Walker" name="og:title" property="og:title"/><meta content="Incremental Versioned Datasets in Kedro | Waylon Walker" name="twitter:title" property="twitter:title"/><meta content="https://images.waylonwalker.com/kedro-incremental-versioned-datasets-og.png" name="og:image" property="og:image"/><meta content="https://images.waylonwalker.com/kedro-incremental-versioned-datasets-og.png" name="twitter:image" property="twitter:image"/><meta content="1600" name="og:image:width" property="og:image:width"/><meta content="900" name="og:image:width" property="og:image:width"/><meta content="summary_large_image" name="twitter:card" property="twitter:card"/><meta content="Waylon Walker" name="og:site_name" property="og:site_name"/><meta content="@_waylonwalker" name="twitter:creator" property="twitter:creator"/><meta content="Incremental Versioned Datasets in Kedro" name="title" property="title"/><meta content="markata 0.1.0" name="generator" property="generator"/><script async src="https://cdn.ampproject.org/v0.js"></script><link href="https://waylonwalker.com/kedro-incremental-versioned-datasets/" rel="canonical"/><meta content="https://waylonwalker.com/kedro-incremental-versioned-datasets/" name="og:url" property="og:url"/></head>
<body>
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="/archive/">Archive</a></li>
<li>
<a aria-label="RSS" href="/rss.xml">
<svg class="icon" height="16" viewbox="0 0 24 24" width="16" xmlns="http://www.w3.org/2000/svg">
<path d="M 4 4.44 v 2.83 c 7.03 0 12.73 5.7 12.73 12.73 h 2.83 c 0 -8.59 -6.97 -15.56 -15.56 -15.56 Z m 0 5.66 v 2.83 c 3.9 0 7.07 3.17 7.07 7.07 h 2.83 c 0 -5.47 -4.43 -9.9 -9.9 -9.9 Z M 6.18 15.64 A 2.18 2.18 0 0 1 6.18 20 A 2.18 2.18 0 0 1 6.18 15.64" fill="currentColor">
</path>
</svg>
</a>
</li>
</ul>
</nav>
<article class="blog-post h-entry">
<!-- <div id='cover-wrapper'>
      <img src='/kedro-incremental-versioned-datasets.webp' alt='cover image for article' />
    </div> -->
<div id="title-wrapper">
<a class="u-url" href="https://waylonwalker.com/kedro-incremental-versioned-datasets/">
<h1 class="flair" id="title" style="text-align:right;z-index:2;padding-right:.2rem">Incremental Versioned Datasets in Kedro
                </h1>
</a>
<p><time class="dt-published post-date" datetime="2021-07-08" style="text-align:right;z-index:2">2021-07-08</time>
</p>
<div class="h-card p-author" rel="author">
<div class="content">
<a class="p-name u-url" href="https://waylonwalker.com/">
<p>
<span class="p-given-name">Waylon</span>
<span class="p-family-name">Walker</span>
</p>
</a>
<p class="p-note">Learning in Public <a href="https://twitter.com/_WaylonWalker">@waylonwalker</a></p>
</div>
</div>
<!-- edit -->
<p><a href="https://github.com/WaylonWalker/waylonwalker.com/edit/main/pages/blog/kedro-incremental-versioned-datasets.md" title="edit this post">edit<span aria-label="" role="img">‚úèÔ∏è</span></a></p>
</div>
<!-- <h2 class='toc'>toc</h2> -->
<!-- -->
<div id="amp-message">
<p style="background: rgba(0,0,0,0.1); padding: .5rem 3rem; margin: 2rem 0rem;">
          ‚ö° You've discovered an amp page, if you bump into any issues such as
          syntax highlighting feel free to jump to the <a href="https://waylonwalker.com/kedro-incremental-versioned-datasets/">normal page</a>
</p>
</div>
<div id="post-body">
<p>Kedro versioned datasets can be mixed with incremental and partitioned datasets
to do some timeseries analysis on how our dataset changes over time.  Kedro is
a very extensible and composible framework, that allows us to build solutions
from the individual components that it provides.  This article is a great
example of how you can combine these components in unique ways to achieve some
powerful results with very little work.</p>
<div class="onelinelink-wrapper">
<a class="onelinelink" href="https://waylonwalker.com/what-is-kedro/">
<amp-img height="500" layout="responsive" src="https://images.waylonwalker.com/what-is-kedro-og_250x140.png" width="500"></amp-img>
<p><strong>
 What is Kedro
</strong></p>
</a>
</div>
<blockquote>
<p>üëÜ Unsure what kedro is?  Check out this post.</p>
</blockquote>
<h2 id="how-does-our-dataset-change-over-time">How does our dataset change over time??</h2>
<p>This was a question presented to me at work.  We had some plots being produces
as the output of our pipeline and the user wanted the ability to compare
results over time.  Luckily this was asked early in the project so we were able
to proactively setup versioning on the right datasets.</p>
<p>To enable this all we needed to do now was to add <code>versioned: true</code> and we will
be able to compare results over time.  Yes kedro makes it that easy to setup.</p>
<h2 id="set-up-a-project">set up a project</h2>
<p>Set up a new project just as usual.  <strong>note</strong> I like using pipx for
global cli packages.  You can pick a specific version of kedro or opt for the
latest while simply globally installing kedro and running kedro new is purely
dependent on the last time you chose to update kedro.</p>
<div class="highlight"><pre><span></span><code>pip install pipx
pipx run kedro new

<span class="nb">cd</span> versioned-partitioned-kedro-example
conda create -n versioned-partitioned-kedro-example <span class="nv">python</span><span class="o">=</span><span class="m">3</span>.8  -y
conda activate versioned-partitioned-kedro-example

pip install kedro
kedro install

git init
git add .
git commit -m <span class="s2">"init project from pipx run kedro new"</span>
</code></pre></div>
<p>I called my project versioned-partitioned-kedro-example. You can call your
project whatever you like.  If you try to use some special characters where
they don't belong, kedro will catch you.  Under the hood, kedro is using a
library called <code>cookiecutter</code></p>
<blockquote>
<p>‚ö†Ô∏è Please do not skip out on using a virtual environment. You may use
whichever virtual environment tool you prefer, but please do not skip out.
Wrecking a running project for learning is not fun.</p>
</blockquote>
<h2 id="update-dependencies">update dependencies</h2>
<p>I popped open my dependencies, added <code>kedro[pandas]</code> and <code>find-kedro</code>. Since those are extra packages our example will require.</p>
<div class="highlight"><pre><span></span><code>aiohttp
black==21.5b1
find-kedro
flake8&gt;=3.7.9, &lt;4.0
ipython
isort~=5.0
jupyter_client&gt;=5.1, &lt;7.0
jupyterlab~=3.0
jupyter~=1.0
kedro-telemetry~=0.1.0
kedro==0.17.4
kedro[pandas]
nbstripout~=0.4
pytest-cov~=2.5
pytest-mock&gt;=1.7.1, &lt;2.0
pytest~=6.2
requests
wheel&gt;=0.35, &lt;0.37
</code></pre></div>
<p><strong>note</strong> I created <code>find-kedro</code>, and I like using it to create my
pipeline object.  Think of how pytest automatically picks up everything named
<code>test</code>, <code>find-kedro</code> does the same thing for kedro.  It picks up everything
with <code>node</code> or <code>pipeline</code> in the name and creates pipelines out of it.</p>
<h2 id="install-new-dependencies">Install new dependencies</h2>
<p>After adding our additional dependencies to the <code>requirements.in</code>, we
can tell kedro to install everything and compile the dependencies.  Behind
the scenes <code>--build-reqs</code> uses a library called <code>pip-compile</code> to create a
<code>requirements.txt</code> file with hard pinned dependencies, which is ideal for
creating reproducible projects.  You and your future colleagues may not thank
you for this, but they sure as heck won't be cursing your name when they can't
get the project to run.</p>
<div class="highlight"><pre><span></span><code>kedro install --build-reqs

git add .
git commit -m <span class="s2">"added additional dependencies"</span>
</code></pre></div>
<h2 id="create-a-node">create a node</h2>
<p>For this example, we need a node to do much.  This node will
pass the <code>cars.csv</code> from a URL to a <code>parquet</code> file.  I am going to use a
lambda to build my identity function inline.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pipelines/cars_nodes.py</span>

<span class="kn">from</span> <span class="nn">kedro.pipeline</span> <span class="kn">import</span> <span class="n">node</span>

<span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">node</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="p">,</span>
            <span class="n">inputs</span><span class="o">=</span><span class="s1">'raw_cars'</span><span class="p">,</span>
            <span class="n">outputs</span><span class="o">=</span><span class="s1">'int_cars'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'create_int_cars'</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
<blockquote>
<p>üóíÔ∏è <strong>note</strong><code>find-kedro' will automatically pick up these nodes for us after we
set up our</code>pipeline_registry.py`.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>git add .
git commit -m <span class="s2">"add create_int_cars node"</span>
</code></pre></div>
<h2 id="implement-find-kedro">implement find-kedro</h2>
<p>Next, we need to tell kedro where our nodes are.  This is where <code>find-kedro</code>
comes in.  Once we point to the directory where our modules of
nodes/pipelines are, it creates the pipelines dictionary for us automatically.  It will even separate each module into a pipeline and stitch them all into one default pipeline.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># pipeline_registry.py</span>

<span class="sd">"""Project pipelines."""</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Dict</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">from</span> <span class="nn">kedro.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>

<span class="kn">from</span> <span class="nn">find_kedro</span> <span class="kn">import</span> <span class="n">find_kedro</span>


<span class="k">def</span> <span class="nf">register_pipelines</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Pipeline</span><span class="p">]:</span>
    <span class="sd">"""Register the project's pipelines.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A mapping from a pipeline name to a "Pipeline "object.</span>
<span class="sd">    """</span>
    <span class="n">pipeline_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">'pipelines'</span>
    <span class="k">return</span> <span class="n">find_kedro</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span> <span class="n">pipeline_dir</span><span class="p">)</span>
</code></pre></div>
<blockquote>
<p>üóíÔ∏è This is very similar to the default ` pipeline_registry'except the last two
lines.</p>
</blockquote>
<div class="highlight"><pre><span></span><code>git add .
git commit -m <span class="s2">"implement find-kedro"</span>
</code></pre></div>
<h2 id="create-a-baseline-catalog">create a baseline catalog</h2>
<p>Once we have a pipeline setup, the kedro cli can automatically fill in missing
catalog entries with  <code>MemoryDataSet</code>'s. Thus, using the cli helps consistently scaffold the
catalog and ensure we don't end up with a typo in our
dataset name.</p>
<div class="highlight"><pre><span></span><code>kedro catalog create --pipeline cars_nodes
</code></pre></div>
<p>Kedro will kick out the following catalog file to <code>base/catalog/cars_nodes.yml</code>
for us to get started with.</p>
<div class="highlight"><pre><span></span><code><span class="nt">raw_cars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MemoryDataSet</span><span class="w"></span>
<span class="nt">int_cars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MemoryDataSet</span><span class="w"></span>
</code></pre></div>
<blockquote>
<p>üî• use the kedro cli to fill in any missing datasets from the automatically
catalog.</p>
</blockquote>
<h2 id="make-a-versioned-dataset">make a versioned dataset</h2>
<p>Kedro has scaffolded <code>MemoryDataSet</code> 's for us.  We will convert them to the
appropriate dataset type and turn on versioning for our <code>int</code> layer, which is
the first point we save in our environment.</p>
<div class="highlight"><pre><span></span><code><span class="nt">raw_cars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.CSVDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">https://waylonwalker.com/cars.csv</span><span class="w"></span>
<span class="nt">int_cars</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.ParquetDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/int_cars.parquet</span><span class="w"></span>
<span class="w">  </span><span class="nt">versioned</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span><span class="w"></span>
</code></pre></div>
<p>Commit your changes to the catalog.</p>
<div class="highlight"><pre><span></span><code>git add .
git commit -m <span class="s2">"create catalog"</span>
</code></pre></div>
<h2 id="run-the-pipeline">run the pipeline</h2>
<p>Once we have the nodes and catalog setup, we can run the pipeline a few times
to get some versioned data.  Each time we run, it will save a new version inside
the <code>int_cars.parquet</code> directory.</p>
<div class="highlight"><pre><span></span><code>kedro run
kedro run
kedro run
kedro run
kedro run
</code></pre></div>
<blockquote>
<p>üóíÔ∏è we put our data in the data directory. By default, this directory is
included in the <code>.gitignore</code> and will not be picked up by git.</p>
</blockquote>
<h2 id="inspect-the-data">inspect the data</h2>
<p>Listing the files in <code>data/int_cars.parquet</code> shows that I now have five different
datasets available.  I can load old ones, but by default, kedro will load the
latest one.</p>
<div class="highlight"><pre><span></span><code>ls data/int_cars.parquet

<span class="m">2021</span>-07-05T15.24.53.164Z
<span class="m">2021</span>-07-05T15.29.56.144Z
<span class="m">2021</span>-07-05T15.30.23.101Z
<span class="m">2021</span>-07-05T15.30.26.555Z
<span class="m">2021</span>-07-05T15.31.12.688Z
</code></pre></div>
<blockquote>
<p>üóíÔ∏è kedro sets the version at the timestamp that the session starts.  All
datasets created within the same run will have the same version.</p>
</blockquote>
<h2 id="stack-on-an-incremental-dataset">stack on an incremental dataset</h2>
<p>This is where things get interesting. Kedro comes with an incremental dataset
that will load all of the files from a particular directory into a dictionary
where the keys are the filename of the dataset.  To load up all datasets into
this dictionary all we need to do is add a new catalog entry that is a  <code>type:
PartitionedDataSet</code>, with a <code>path</code> pointing to the same place as the original,
and a <code>dataset</code> type the same as the original.</p>
<div class="highlight"><pre><span></span><code><span class="nt">int_cars_partitioned</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PartitionedDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.ParquetDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/int_cars.parquet</span><span class="w"></span>
</code></pre></div>
<h2 id="catalog-list">catalog list</h2>
<p>Listing the catalog entries confirms that we have successfully added our new <code>PartitionedDataSet</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">17</span><span class="p">]:</span> <span class="n">context</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">17</span><span class="p">]:</span>
<span class="p">[</span><span class="s1">'raw_cars'</span><span class="p">,</span>
 <span class="s1">'int_cars'</span><span class="p">,</span>
 <span class="s1">'int_cars_partitioned'</span><span class="p">,</span>
 <span class="s1">'parameters'</span><span class="p">]</span>
</code></pre></div>
<h2 id="loading-an-incremental-dataset">loading an incremental dataset</h2>
<p>Now we can easily load the datasets from every run we just did into a single
dictionary, simply by running <code>context.catalog.load('int_cars_incremental')</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">19</span><span class="p">]:</span> <span class="n">context</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'int_cars_incremental'</span><span class="p">)</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span> <span class="mi">11</span><span class="p">:</span><span class="mi">32</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span><span class="mi">534</span> <span class="o">-</span> <span class="n">kedro</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">Loading</span> <span class="n">data</span> <span class="kn">from</span> <span class="err">`</span><span class="n">int_cars_incremental</span><span class="err">`</span> <span class="p">(</span><span class="n">IncrementalDataSet</span><span class="p">)</span><span class="o">...</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">19</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">'2021-07-05T15.29.56.144Z/int_cars.parquet'</span><span class="p">:</span>              <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span>   <span class="n">mpg</span>  <span class="n">cyl</span>   <span class="n">disp</span>   <span class="n">hp</span>  <span class="n">drat</span>     <span class="n">wt</span>   <span class="n">qsec</span>  <span class="n">vs</span>  <span class="n">am</span>  <span class="n">gear</span>  <span class="n">carb</span>
 <span class="mi">0</span>             <span class="n">Mazda</span> <span class="n">RX4</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.620</span>  <span class="mf">16.46</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">1</span>         <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.875</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">2</span>            <span class="n">Datsun</span> <span class="mi">710</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">108.0</span>   <span class="mi">93</span>  <span class="mf">3.85</span>  <span class="mf">2.320</span>  <span class="mf">18.61</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">3</span>        <span class="n">Hornet</span> <span class="mi">4</span> <span class="n">Drive</span>  <span class="mf">21.4</span>    <span class="mi">6</span>  <span class="mf">258.0</span>  <span class="mi">110</span>  <span class="mf">3.08</span>  <span class="mf">3.215</span>  <span class="mf">19.44</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">4</span>     <span class="n">Hornet</span> <span class="n">Sportabout</span>  <span class="mf">18.7</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">175</span>  <span class="mf">3.15</span>  <span class="mf">3.440</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">5</span>               <span class="n">Valiant</span>  <span class="mf">18.1</span>    <span class="mi">6</span>  <span class="mf">225.0</span>  <span class="mi">105</span>  <span class="mf">2.76</span>  <span class="mf">3.460</span>  <span class="mf">20.22</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">6</span>            <span class="n">Duster</span> <span class="mi">360</span>  <span class="mf">14.3</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">245</span>  <span class="mf">3.21</span>  <span class="mf">3.570</span>  <span class="mf">15.84</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">7</span>             <span class="n">Merc</span> <span class="mi">240</span><span class="n">D</span>  <span class="mf">24.4</span>    <span class="mi">4</span>  <span class="mf">146.7</span>   <span class="mi">62</span>  <span class="mf">3.69</span>  <span class="mf">3.190</span>  <span class="mf">20.00</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">8</span>              <span class="n">Merc</span> <span class="mi">230</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">140.8</span>   <span class="mi">95</span>  <span class="mf">3.92</span>  <span class="mf">3.150</span>  <span class="mf">22.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">9</span>              <span class="n">Merc</span> <span class="mi">280</span>  <span class="mf">19.2</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.30</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">10</span>            <span class="n">Merc</span> <span class="mi">280</span><span class="n">C</span>  <span class="mf">17.8</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">11</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SE</span>  <span class="mf">16.4</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">4.070</span>  <span class="mf">17.40</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">12</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SL</span>  <span class="mf">17.3</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.730</span>  <span class="mf">17.60</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">13</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SLC</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.780</span>  <span class="mf">18.00</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">14</span>   <span class="n">Cadillac</span> <span class="n">Fleetwood</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">472.0</span>  <span class="mi">205</span>  <span class="mf">2.93</span>  <span class="mf">5.250</span>  <span class="mf">17.98</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">15</span>  <span class="n">Lincoln</span> <span class="n">Continental</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">460.0</span>  <span class="mi">215</span>  <span class="mf">3.00</span>  <span class="mf">5.424</span>  <span class="mf">17.82</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">16</span>    <span class="n">Chrysler</span> <span class="n">Imperial</span>  <span class="mf">14.7</span>    <span class="mi">8</span>  <span class="mf">440.0</span>  <span class="mi">230</span>  <span class="mf">3.23</span>  <span class="mf">5.345</span>  <span class="mf">17.42</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">17</span>             <span class="n">Fiat</span> <span class="mi">128</span>  <span class="mf">32.4</span>    <span class="mi">4</span>   <span class="mf">78.7</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">2.200</span>  <span class="mf">19.47</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">18</span>          <span class="n">Honda</span> <span class="n">Civic</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">75.7</span>   <span class="mi">52</span>  <span class="mf">4.93</span>  <span class="mf">1.615</span>  <span class="mf">18.52</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">19</span>       <span class="n">Toyota</span> <span class="n">Corolla</span>  <span class="mf">33.9</span>    <span class="mi">4</span>   <span class="mf">71.1</span>   <span class="mi">65</span>  <span class="mf">4.22</span>  <span class="mf">1.835</span>  <span class="mf">19.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">20</span>        <span class="n">Toyota</span> <span class="n">Corona</span>  <span class="mf">21.5</span>    <span class="mi">4</span>  <span class="mf">120.1</span>   <span class="mi">97</span>  <span class="mf">3.70</span>  <span class="mf">2.465</span>  <span class="mf">20.01</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">21</span>     <span class="n">Dodge</span> <span class="n">Challenger</span>  <span class="mf">15.5</span>    <span class="mi">8</span>  <span class="mf">318.0</span>  <span class="mi">150</span>  <span class="mf">2.76</span>  <span class="mf">3.520</span>  <span class="mf">16.87</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">22</span>          <span class="n">AMC</span> <span class="n">Javelin</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">304.0</span>  <span class="mi">150</span>  <span class="mf">3.15</span>  <span class="mf">3.435</span>  <span class="mf">17.30</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">23</span>           <span class="n">Camaro</span> <span class="n">Z28</span>  <span class="mf">13.3</span>    <span class="mi">8</span>  <span class="mf">350.0</span>  <span class="mi">245</span>  <span class="mf">3.73</span>  <span class="mf">3.840</span>  <span class="mf">15.41</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">24</span>     <span class="n">Pontiac</span> <span class="n">Firebird</span>  <span class="mf">19.2</span>    <span class="mi">8</span>  <span class="mf">400.0</span>  <span class="mi">175</span>  <span class="mf">3.08</span>  <span class="mf">3.845</span>  <span class="mf">17.05</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">25</span>            <span class="n">Fiat</span> <span class="n">X1</span><span class="o">-</span><span class="mi">9</span>  <span class="mf">27.3</span>    <span class="mi">4</span>   <span class="mf">79.0</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">1.935</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">26</span>        <span class="n">Porsche</span> <span class="mi">914</span><span class="o">-</span><span class="mi">2</span>  <span class="mf">26.0</span>    <span class="mi">4</span>  <span class="mf">120.3</span>   <span class="mi">91</span>  <span class="mf">4.43</span>  <span class="mf">2.140</span>  <span class="mf">16.70</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">27</span>         <span class="n">Lotus</span> <span class="n">Europa</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">95.1</span>  <span class="mi">113</span>  <span class="mf">3.77</span>  <span class="mf">1.513</span>  <span class="mf">16.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">28</span>       <span class="n">Ford</span> <span class="n">Pantera</span> <span class="n">L</span>  <span class="mf">15.8</span>    <span class="mi">8</span>  <span class="mf">351.0</span>  <span class="mi">264</span>  <span class="mf">4.22</span>  <span class="mf">3.170</span>  <span class="mf">14.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">4</span>
 <span class="mi">29</span>         <span class="n">Ferrari</span> <span class="n">Dino</span>  <span class="mf">19.7</span>    <span class="mi">6</span>  <span class="mf">145.0</span>  <span class="mi">175</span>  <span class="mf">3.62</span>  <span class="mf">2.770</span>  <span class="mf">15.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">6</span>
 <span class="mi">30</span>        <span class="n">Maserati</span> <span class="n">Bora</span>  <span class="mf">15.0</span>    <span class="mi">8</span>  <span class="mf">301.0</span>  <span class="mi">335</span>  <span class="mf">3.54</span>  <span class="mf">3.570</span>  <span class="mf">14.60</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">8</span>
 <span class="mi">31</span>           <span class="n">Volvo</span> <span class="mi">142</span><span class="n">E</span>  <span class="mf">21.4</span>    <span class="mi">4</span>  <span class="mf">121.0</span>  <span class="mi">109</span>  <span class="mf">4.11</span>  <span class="mf">2.780</span>  <span class="mf">18.60</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.23.101Z/int_cars.parquet'</span><span class="p">:</span>              <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span>   <span class="n">mpg</span>  <span class="n">cyl</span>   <span class="n">disp</span>   <span class="n">hp</span>  <span class="n">drat</span>     <span class="n">wt</span>   <span class="n">qsec</span>  <span class="n">vs</span>  <span class="n">am</span>  <span class="n">gear</span>  <span class="n">carb</span>
 <span class="mi">0</span>             <span class="n">Mazda</span> <span class="n">RX4</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.620</span>  <span class="mf">16.46</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">1</span>         <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.875</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">2</span>            <span class="n">Datsun</span> <span class="mi">710</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">108.0</span>   <span class="mi">93</span>  <span class="mf">3.85</span>  <span class="mf">2.320</span>  <span class="mf">18.61</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">3</span>        <span class="n">Hornet</span> <span class="mi">4</span> <span class="n">Drive</span>  <span class="mf">21.4</span>    <span class="mi">6</span>  <span class="mf">258.0</span>  <span class="mi">110</span>  <span class="mf">3.08</span>  <span class="mf">3.215</span>  <span class="mf">19.44</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">4</span>     <span class="n">Hornet</span> <span class="n">Sportabout</span>  <span class="mf">18.7</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">175</span>  <span class="mf">3.15</span>  <span class="mf">3.440</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">5</span>               <span class="n">Valiant</span>  <span class="mf">18.1</span>    <span class="mi">6</span>  <span class="mf">225.0</span>  <span class="mi">105</span>  <span class="mf">2.76</span>  <span class="mf">3.460</span>  <span class="mf">20.22</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">6</span>            <span class="n">Duster</span> <span class="mi">360</span>  <span class="mf">14.3</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">245</span>  <span class="mf">3.21</span>  <span class="mf">3.570</span>  <span class="mf">15.84</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">7</span>             <span class="n">Merc</span> <span class="mi">240</span><span class="n">D</span>  <span class="mf">24.4</span>    <span class="mi">4</span>  <span class="mf">146.7</span>   <span class="mi">62</span>  <span class="mf">3.69</span>  <span class="mf">3.190</span>  <span class="mf">20.00</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">8</span>              <span class="n">Merc</span> <span class="mi">230</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">140.8</span>   <span class="mi">95</span>  <span class="mf">3.92</span>  <span class="mf">3.150</span>  <span class="mf">22.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">9</span>              <span class="n">Merc</span> <span class="mi">280</span>  <span class="mf">19.2</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.30</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">10</span>            <span class="n">Merc</span> <span class="mi">280</span><span class="n">C</span>  <span class="mf">17.8</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">11</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SE</span>  <span class="mf">16.4</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">4.070</span>  <span class="mf">17.40</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">12</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SL</span>  <span class="mf">17.3</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.730</span>  <span class="mf">17.60</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">13</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SLC</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.780</span>  <span class="mf">18.00</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">14</span>   <span class="n">Cadillac</span> <span class="n">Fleetwood</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">472.0</span>  <span class="mi">205</span>  <span class="mf">2.93</span>  <span class="mf">5.250</span>  <span class="mf">17.98</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">15</span>  <span class="n">Lincoln</span> <span class="n">Continental</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">460.0</span>  <span class="mi">215</span>  <span class="mf">3.00</span>  <span class="mf">5.424</span>  <span class="mf">17.82</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">16</span>    <span class="n">Chrysler</span> <span class="n">Imperial</span>  <span class="mf">14.7</span>    <span class="mi">8</span>  <span class="mf">440.0</span>  <span class="mi">230</span>  <span class="mf">3.23</span>  <span class="mf">5.345</span>  <span class="mf">17.42</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">17</span>             <span class="n">Fiat</span> <span class="mi">128</span>  <span class="mf">32.4</span>    <span class="mi">4</span>   <span class="mf">78.7</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">2.200</span>  <span class="mf">19.47</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">18</span>          <span class="n">Honda</span> <span class="n">Civic</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">75.7</span>   <span class="mi">52</span>  <span class="mf">4.93</span>  <span class="mf">1.615</span>  <span class="mf">18.52</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">19</span>       <span class="n">Toyota</span> <span class="n">Corolla</span>  <span class="mf">33.9</span>    <span class="mi">4</span>   <span class="mf">71.1</span>   <span class="mi">65</span>  <span class="mf">4.22</span>  <span class="mf">1.835</span>  <span class="mf">19.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">20</span>        <span class="n">Toyota</span> <span class="n">Corona</span>  <span class="mf">21.5</span>    <span class="mi">4</span>  <span class="mf">120.1</span>   <span class="mi">97</span>  <span class="mf">3.70</span>  <span class="mf">2.465</span>  <span class="mf">20.01</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">21</span>     <span class="n">Dodge</span> <span class="n">Challenger</span>  <span class="mf">15.5</span>    <span class="mi">8</span>  <span class="mf">318.0</span>  <span class="mi">150</span>  <span class="mf">2.76</span>  <span class="mf">3.520</span>  <span class="mf">16.87</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">22</span>          <span class="n">AMC</span> <span class="n">Javelin</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">304.0</span>  <span class="mi">150</span>  <span class="mf">3.15</span>  <span class="mf">3.435</span>  <span class="mf">17.30</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">23</span>           <span class="n">Camaro</span> <span class="n">Z28</span>  <span class="mf">13.3</span>    <span class="mi">8</span>  <span class="mf">350.0</span>  <span class="mi">245</span>  <span class="mf">3.73</span>  <span class="mf">3.840</span>  <span class="mf">15.41</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">24</span>     <span class="n">Pontiac</span> <span class="n">Firebird</span>  <span class="mf">19.2</span>    <span class="mi">8</span>  <span class="mf">400.0</span>  <span class="mi">175</span>  <span class="mf">3.08</span>  <span class="mf">3.845</span>  <span class="mf">17.05</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">25</span>            <span class="n">Fiat</span> <span class="n">X1</span><span class="o">-</span><span class="mi">9</span>  <span class="mf">27.3</span>    <span class="mi">4</span>   <span class="mf">79.0</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">1.935</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">26</span>        <span class="n">Porsche</span> <span class="mi">914</span><span class="o">-</span><span class="mi">2</span>  <span class="mf">26.0</span>    <span class="mi">4</span>  <span class="mf">120.3</span>   <span class="mi">91</span>  <span class="mf">4.43</span>  <span class="mf">2.140</span>  <span class="mf">16.70</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">27</span>         <span class="n">Lotus</span> <span class="n">Europa</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">95.1</span>  <span class="mi">113</span>  <span class="mf">3.77</span>  <span class="mf">1.513</span>  <span class="mf">16.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">28</span>       <span class="n">Ford</span> <span class="n">Pantera</span> <span class="n">L</span>  <span class="mf">15.8</span>    <span class="mi">8</span>  <span class="mf">351.0</span>  <span class="mi">264</span>  <span class="mf">4.22</span>  <span class="mf">3.170</span>  <span class="mf">14.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">4</span>
 <span class="mi">29</span>         <span class="n">Ferrari</span> <span class="n">Dino</span>  <span class="mf">19.7</span>    <span class="mi">6</span>  <span class="mf">145.0</span>  <span class="mi">175</span>  <span class="mf">3.62</span>  <span class="mf">2.770</span>  <span class="mf">15.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">6</span>
 <span class="mi">30</span>        <span class="n">Maserati</span> <span class="n">Bora</span>  <span class="mf">15.0</span>    <span class="mi">8</span>  <span class="mf">301.0</span>  <span class="mi">335</span>  <span class="mf">3.54</span>  <span class="mf">3.570</span>  <span class="mf">14.60</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">8</span>
 <span class="mi">31</span>           <span class="n">Volvo</span> <span class="mi">142</span><span class="n">E</span>  <span class="mf">21.4</span>    <span class="mi">4</span>  <span class="mf">121.0</span>  <span class="mi">109</span>  <span class="mf">4.11</span>  <span class="mf">2.780</span>  <span class="mf">18.60</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.26.555Z/int_cars.parquet'</span><span class="p">:</span>              <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span>   <span class="n">mpg</span>  <span class="n">cyl</span>   <span class="n">disp</span>   <span class="n">hp</span>  <span class="n">drat</span>     <span class="n">wt</span>   <span class="n">qsec</span>  <span class="n">vs</span>  <span class="n">am</span>  <span class="n">gear</span>  <span class="n">carb</span>
 <span class="mi">0</span>             <span class="n">Mazda</span> <span class="n">RX4</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.620</span>  <span class="mf">16.46</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">1</span>         <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.875</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">2</span>            <span class="n">Datsun</span> <span class="mi">710</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">108.0</span>   <span class="mi">93</span>  <span class="mf">3.85</span>  <span class="mf">2.320</span>  <span class="mf">18.61</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">3</span>        <span class="n">Hornet</span> <span class="mi">4</span> <span class="n">Drive</span>  <span class="mf">21.4</span>    <span class="mi">6</span>  <span class="mf">258.0</span>  <span class="mi">110</span>  <span class="mf">3.08</span>  <span class="mf">3.215</span>  <span class="mf">19.44</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">4</span>     <span class="n">Hornet</span> <span class="n">Sportabout</span>  <span class="mf">18.7</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">175</span>  <span class="mf">3.15</span>  <span class="mf">3.440</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">5</span>               <span class="n">Valiant</span>  <span class="mf">18.1</span>    <span class="mi">6</span>  <span class="mf">225.0</span>  <span class="mi">105</span>  <span class="mf">2.76</span>  <span class="mf">3.460</span>  <span class="mf">20.22</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">6</span>            <span class="n">Duster</span> <span class="mi">360</span>  <span class="mf">14.3</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">245</span>  <span class="mf">3.21</span>  <span class="mf">3.570</span>  <span class="mf">15.84</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">7</span>             <span class="n">Merc</span> <span class="mi">240</span><span class="n">D</span>  <span class="mf">24.4</span>    <span class="mi">4</span>  <span class="mf">146.7</span>   <span class="mi">62</span>  <span class="mf">3.69</span>  <span class="mf">3.190</span>  <span class="mf">20.00</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">8</span>              <span class="n">Merc</span> <span class="mi">230</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">140.8</span>   <span class="mi">95</span>  <span class="mf">3.92</span>  <span class="mf">3.150</span>  <span class="mf">22.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">9</span>              <span class="n">Merc</span> <span class="mi">280</span>  <span class="mf">19.2</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.30</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">10</span>            <span class="n">Merc</span> <span class="mi">280</span><span class="n">C</span>  <span class="mf">17.8</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">11</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SE</span>  <span class="mf">16.4</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">4.070</span>  <span class="mf">17.40</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">12</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SL</span>  <span class="mf">17.3</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.730</span>  <span class="mf">17.60</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">13</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SLC</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.780</span>  <span class="mf">18.00</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">14</span>   <span class="n">Cadillac</span> <span class="n">Fleetwood</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">472.0</span>  <span class="mi">205</span>  <span class="mf">2.93</span>  <span class="mf">5.250</span>  <span class="mf">17.98</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">15</span>  <span class="n">Lincoln</span> <span class="n">Continental</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">460.0</span>  <span class="mi">215</span>  <span class="mf">3.00</span>  <span class="mf">5.424</span>  <span class="mf">17.82</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">16</span>    <span class="n">Chrysler</span> <span class="n">Imperial</span>  <span class="mf">14.7</span>    <span class="mi">8</span>  <span class="mf">440.0</span>  <span class="mi">230</span>  <span class="mf">3.23</span>  <span class="mf">5.345</span>  <span class="mf">17.42</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">17</span>             <span class="n">Fiat</span> <span class="mi">128</span>  <span class="mf">32.4</span>    <span class="mi">4</span>   <span class="mf">78.7</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">2.200</span>  <span class="mf">19.47</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">18</span>          <span class="n">Honda</span> <span class="n">Civic</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">75.7</span>   <span class="mi">52</span>  <span class="mf">4.93</span>  <span class="mf">1.615</span>  <span class="mf">18.52</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">19</span>       <span class="n">Toyota</span> <span class="n">Corolla</span>  <span class="mf">33.9</span>    <span class="mi">4</span>   <span class="mf">71.1</span>   <span class="mi">65</span>  <span class="mf">4.22</span>  <span class="mf">1.835</span>  <span class="mf">19.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">20</span>        <span class="n">Toyota</span> <span class="n">Corona</span>  <span class="mf">21.5</span>    <span class="mi">4</span>  <span class="mf">120.1</span>   <span class="mi">97</span>  <span class="mf">3.70</span>  <span class="mf">2.465</span>  <span class="mf">20.01</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">21</span>     <span class="n">Dodge</span> <span class="n">Challenger</span>  <span class="mf">15.5</span>    <span class="mi">8</span>  <span class="mf">318.0</span>  <span class="mi">150</span>  <span class="mf">2.76</span>  <span class="mf">3.520</span>  <span class="mf">16.87</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">22</span>          <span class="n">AMC</span> <span class="n">Javelin</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">304.0</span>  <span class="mi">150</span>  <span class="mf">3.15</span>  <span class="mf">3.435</span>  <span class="mf">17.30</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">23</span>           <span class="n">Camaro</span> <span class="n">Z28</span>  <span class="mf">13.3</span>    <span class="mi">8</span>  <span class="mf">350.0</span>  <span class="mi">245</span>  <span class="mf">3.73</span>  <span class="mf">3.840</span>  <span class="mf">15.41</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">24</span>     <span class="n">Pontiac</span> <span class="n">Firebird</span>  <span class="mf">19.2</span>    <span class="mi">8</span>  <span class="mf">400.0</span>  <span class="mi">175</span>  <span class="mf">3.08</span>  <span class="mf">3.845</span>  <span class="mf">17.05</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">25</span>            <span class="n">Fiat</span> <span class="n">X1</span><span class="o">-</span><span class="mi">9</span>  <span class="mf">27.3</span>    <span class="mi">4</span>   <span class="mf">79.0</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">1.935</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">26</span>        <span class="n">Porsche</span> <span class="mi">914</span><span class="o">-</span><span class="mi">2</span>  <span class="mf">26.0</span>    <span class="mi">4</span>  <span class="mf">120.3</span>   <span class="mi">91</span>  <span class="mf">4.43</span>  <span class="mf">2.140</span>  <span class="mf">16.70</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">27</span>         <span class="n">Lotus</span> <span class="n">Europa</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">95.1</span>  <span class="mi">113</span>  <span class="mf">3.77</span>  <span class="mf">1.513</span>  <span class="mf">16.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">28</span>       <span class="n">Ford</span> <span class="n">Pantera</span> <span class="n">L</span>  <span class="mf">15.8</span>    <span class="mi">8</span>  <span class="mf">351.0</span>  <span class="mi">264</span>  <span class="mf">4.22</span>  <span class="mf">3.170</span>  <span class="mf">14.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">4</span>
 <span class="mi">29</span>         <span class="n">Ferrari</span> <span class="n">Dino</span>  <span class="mf">19.7</span>    <span class="mi">6</span>  <span class="mf">145.0</span>  <span class="mi">175</span>  <span class="mf">3.62</span>  <span class="mf">2.770</span>  <span class="mf">15.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">6</span>
 <span class="mi">30</span>        <span class="n">Maserati</span> <span class="n">Bora</span>  <span class="mf">15.0</span>    <span class="mi">8</span>  <span class="mf">301.0</span>  <span class="mi">335</span>  <span class="mf">3.54</span>  <span class="mf">3.570</span>  <span class="mf">14.60</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">8</span>
 <span class="mi">31</span>           <span class="n">Volvo</span> <span class="mi">142</span><span class="n">E</span>  <span class="mf">21.4</span>    <span class="mi">4</span>  <span class="mf">121.0</span>  <span class="mi">109</span>  <span class="mf">4.11</span>  <span class="mf">2.780</span>  <span class="mf">18.60</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.31.12.688Z/int_cars.parquet'</span><span class="p">:</span>              <span class="n">Unnamed</span><span class="p">:</span> <span class="mi">0</span>   <span class="n">mpg</span>  <span class="n">cyl</span>   <span class="n">disp</span>   <span class="n">hp</span>  <span class="n">drat</span>     <span class="n">wt</span>   <span class="n">qsec</span>  <span class="n">vs</span>  <span class="n">am</span>  <span class="n">gear</span>  <span class="n">carb</span>
 <span class="mi">0</span>             <span class="n">Mazda</span> <span class="n">RX4</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.620</span>  <span class="mf">16.46</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">1</span>         <span class="n">Mazda</span> <span class="n">RX4</span> <span class="n">Wag</span>  <span class="mf">21.0</span>    <span class="mi">6</span>  <span class="mf">160.0</span>  <span class="mi">110</span>  <span class="mf">3.90</span>  <span class="mf">2.875</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">2</span>            <span class="n">Datsun</span> <span class="mi">710</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">108.0</span>   <span class="mi">93</span>  <span class="mf">3.85</span>  <span class="mf">2.320</span>  <span class="mf">18.61</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">3</span>        <span class="n">Hornet</span> <span class="mi">4</span> <span class="n">Drive</span>  <span class="mf">21.4</span>    <span class="mi">6</span>  <span class="mf">258.0</span>  <span class="mi">110</span>  <span class="mf">3.08</span>  <span class="mf">3.215</span>  <span class="mf">19.44</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">4</span>     <span class="n">Hornet</span> <span class="n">Sportabout</span>  <span class="mf">18.7</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">175</span>  <span class="mf">3.15</span>  <span class="mf">3.440</span>  <span class="mf">17.02</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">5</span>               <span class="n">Valiant</span>  <span class="mf">18.1</span>    <span class="mi">6</span>  <span class="mf">225.0</span>  <span class="mi">105</span>  <span class="mf">2.76</span>  <span class="mf">3.460</span>  <span class="mf">20.22</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">6</span>            <span class="n">Duster</span> <span class="mi">360</span>  <span class="mf">14.3</span>    <span class="mi">8</span>  <span class="mf">360.0</span>  <span class="mi">245</span>  <span class="mf">3.21</span>  <span class="mf">3.570</span>  <span class="mf">15.84</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">7</span>             <span class="n">Merc</span> <span class="mi">240</span><span class="n">D</span>  <span class="mf">24.4</span>    <span class="mi">4</span>  <span class="mf">146.7</span>   <span class="mi">62</span>  <span class="mf">3.69</span>  <span class="mf">3.190</span>  <span class="mf">20.00</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">8</span>              <span class="n">Merc</span> <span class="mi">230</span>  <span class="mf">22.8</span>    <span class="mi">4</span>  <span class="mf">140.8</span>   <span class="mi">95</span>  <span class="mf">3.92</span>  <span class="mf">3.150</span>  <span class="mf">22.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">9</span>              <span class="n">Merc</span> <span class="mi">280</span>  <span class="mf">19.2</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.30</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">10</span>            <span class="n">Merc</span> <span class="mi">280</span><span class="n">C</span>  <span class="mf">17.8</span>    <span class="mi">6</span>  <span class="mf">167.6</span>  <span class="mi">123</span>  <span class="mf">3.92</span>  <span class="mf">3.440</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">4</span>     <span class="mi">4</span>
 <span class="mi">11</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SE</span>  <span class="mf">16.4</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">4.070</span>  <span class="mf">17.40</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">12</span>           <span class="n">Merc</span> <span class="mi">450</span><span class="n">SL</span>  <span class="mf">17.3</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.730</span>  <span class="mf">17.60</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">13</span>          <span class="n">Merc</span> <span class="mi">450</span><span class="n">SLC</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">275.8</span>  <span class="mi">180</span>  <span class="mf">3.07</span>  <span class="mf">3.780</span>  <span class="mf">18.00</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">3</span>
 <span class="mi">14</span>   <span class="n">Cadillac</span> <span class="n">Fleetwood</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">472.0</span>  <span class="mi">205</span>  <span class="mf">2.93</span>  <span class="mf">5.250</span>  <span class="mf">17.98</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">15</span>  <span class="n">Lincoln</span> <span class="n">Continental</span>  <span class="mf">10.4</span>    <span class="mi">8</span>  <span class="mf">460.0</span>  <span class="mi">215</span>  <span class="mf">3.00</span>  <span class="mf">5.424</span>  <span class="mf">17.82</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">16</span>    <span class="n">Chrysler</span> <span class="n">Imperial</span>  <span class="mf">14.7</span>    <span class="mi">8</span>  <span class="mf">440.0</span>  <span class="mi">230</span>  <span class="mf">3.23</span>  <span class="mf">5.345</span>  <span class="mf">17.42</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">17</span>             <span class="n">Fiat</span> <span class="mi">128</span>  <span class="mf">32.4</span>    <span class="mi">4</span>   <span class="mf">78.7</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">2.200</span>  <span class="mf">19.47</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">18</span>          <span class="n">Honda</span> <span class="n">Civic</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">75.7</span>   <span class="mi">52</span>  <span class="mf">4.93</span>  <span class="mf">1.615</span>  <span class="mf">18.52</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span>
 <span class="mi">19</span>       <span class="n">Toyota</span> <span class="n">Corolla</span>  <span class="mf">33.9</span>    <span class="mi">4</span>   <span class="mf">71.1</span>   <span class="mi">65</span>  <span class="mf">4.22</span>  <span class="mf">1.835</span>  <span class="mf">19.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">20</span>        <span class="n">Toyota</span> <span class="n">Corona</span>  <span class="mf">21.5</span>    <span class="mi">4</span>  <span class="mf">120.1</span>   <span class="mi">97</span>  <span class="mf">3.70</span>  <span class="mf">2.465</span>  <span class="mf">20.01</span>   <span class="mi">1</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">1</span>
 <span class="mi">21</span>     <span class="n">Dodge</span> <span class="n">Challenger</span>  <span class="mf">15.5</span>    <span class="mi">8</span>  <span class="mf">318.0</span>  <span class="mi">150</span>  <span class="mf">2.76</span>  <span class="mf">3.520</span>  <span class="mf">16.87</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">22</span>          <span class="n">AMC</span> <span class="n">Javelin</span>  <span class="mf">15.2</span>    <span class="mi">8</span>  <span class="mf">304.0</span>  <span class="mi">150</span>  <span class="mf">3.15</span>  <span class="mf">3.435</span>  <span class="mf">17.30</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">23</span>           <span class="n">Camaro</span> <span class="n">Z28</span>  <span class="mf">13.3</span>    <span class="mi">8</span>  <span class="mf">350.0</span>  <span class="mi">245</span>  <span class="mf">3.73</span>  <span class="mf">3.840</span>  <span class="mf">15.41</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">4</span>
 <span class="mi">24</span>     <span class="n">Pontiac</span> <span class="n">Firebird</span>  <span class="mf">19.2</span>    <span class="mi">8</span>  <span class="mf">400.0</span>  <span class="mi">175</span>  <span class="mf">3.08</span>  <span class="mf">3.845</span>  <span class="mf">17.05</span>   <span class="mi">0</span>   <span class="mi">0</span>     <span class="mi">3</span>     <span class="mi">2</span>
 <span class="mi">25</span>            <span class="n">Fiat</span> <span class="n">X1</span><span class="o">-</span><span class="mi">9</span>  <span class="mf">27.3</span>    <span class="mi">4</span>   <span class="mf">79.0</span>   <span class="mi">66</span>  <span class="mf">4.08</span>  <span class="mf">1.935</span>  <span class="mf">18.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">1</span>
 <span class="mi">26</span>        <span class="n">Porsche</span> <span class="mi">914</span><span class="o">-</span><span class="mi">2</span>  <span class="mf">26.0</span>    <span class="mi">4</span>  <span class="mf">120.3</span>   <span class="mi">91</span>  <span class="mf">4.43</span>  <span class="mf">2.140</span>  <span class="mf">16.70</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">27</span>         <span class="n">Lotus</span> <span class="n">Europa</span>  <span class="mf">30.4</span>    <span class="mi">4</span>   <span class="mf">95.1</span>  <span class="mi">113</span>  <span class="mf">3.77</span>  <span class="mf">1.513</span>  <span class="mf">16.90</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">2</span>
 <span class="mi">28</span>       <span class="n">Ford</span> <span class="n">Pantera</span> <span class="n">L</span>  <span class="mf">15.8</span>    <span class="mi">8</span>  <span class="mf">351.0</span>  <span class="mi">264</span>  <span class="mf">4.22</span>  <span class="mf">3.170</span>  <span class="mf">14.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">4</span>
 <span class="mi">29</span>         <span class="n">Ferrari</span> <span class="n">Dino</span>  <span class="mf">19.7</span>    <span class="mi">6</span>  <span class="mf">145.0</span>  <span class="mi">175</span>  <span class="mf">3.62</span>  <span class="mf">2.770</span>  <span class="mf">15.50</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">6</span>
 <span class="mi">30</span>        <span class="n">Maserati</span> <span class="n">Bora</span>  <span class="mf">15.0</span>    <span class="mi">8</span>  <span class="mf">301.0</span>  <span class="mi">335</span>  <span class="mf">3.54</span>  <span class="mf">3.570</span>  <span class="mf">14.60</span>   <span class="mi">0</span>   <span class="mi">1</span>     <span class="mi">5</span>     <span class="mi">8</span>
 <span class="mi">31</span>           <span class="n">Volvo</span> <span class="mi">142</span><span class="n">E</span>  <span class="mf">21.4</span>    <span class="mi">4</span>  <span class="mf">121.0</span>  <span class="mi">109</span>  <span class="mf">4.11</span>  <span class="mf">2.780</span>  <span class="mf">18.60</span>   <span class="mi">1</span>   <span class="mi">1</span>     <span class="mi">4</span>     <span class="mi">2</span><span class="p">}</span>
</code></pre></div>
<blockquote>
<p>üëÜ notice that incremental datasets are all loaded for you, its a dict of <code>filepath:dataset</code></p>
</blockquote>
<h2 id="stack-on-a-partitioned-dataset">stack on a partitioned dataset</h2>
<p>Let's take a look at a similar type of dataset called <code>PartitionedDataSet</code>.  We
can add it to the catalog in a very similar way to how we added the
<code>IncrementalDataSet</code>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">int_cars_incremental</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IncrementalDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">dataset</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pandas.ParquetDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/int_cars.parquet</span><span class="w"></span>
</code></pre></div>
<h2 id="loading-a-partitioned-dataset">loading a partitioned dataset</h2>
<p>Note that we get a dict with the same keys as before, but this time the
values are a load function rather than loaded data.  Partitioned datasets can be helpful if
you are operating on datasets that take up more memory than you have available.
In our case of coupling this with versioned datasets, its likely to grow quite
large, so <code>PartitionedDataSet</code> 's are likely a better option for this use.</p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">18</span><span class="p">]:</span> <span class="n">context</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'int_cars_partitioned'</span><span class="p">)</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span> <span class="mi">11</span><span class="p">:</span><span class="mi">31</span><span class="p">:</span><span class="mi">11</span><span class="p">,</span><span class="mi">253</span> <span class="o">-</span> <span class="n">kedro</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">Loading</span> <span class="n">data</span> <span class="kn">from</span> <span class="err">`</span><span class="n">int_cars_partitioned</span><span class="err">`</span> <span class="p">(</span><span class="n">PartitionedDataSet</span><span class="p">)</span><span class="o">...</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">18</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">'2021-07-05T15.29.56.144Z/int_cars.parquet'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">AbstractVersionedDataSet</span><span class="o">.</span><span class="n">load</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">kedro</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">parquet_dataset</span><span class="o">.</span><span class="n">ParquetDataSet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4bb1570820</span><span class="o">&gt;&gt;</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.23.101Z/int_cars.parquet'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">AbstractVersionedDataSet</span><span class="o">.</span><span class="n">load</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">kedro</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">parquet_dataset</span><span class="o">.</span><span class="n">ParquetDataSet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4bb1570850</span><span class="o">&gt;&gt;</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.26.555Z/int_cars.parquet'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">AbstractVersionedDataSet</span><span class="o">.</span><span class="n">load</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">kedro</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">parquet_dataset</span><span class="o">.</span><span class="n">ParquetDataSet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4bb1570910</span><span class="o">&gt;&gt;</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.31.12.688Z/int_cars.parquet'</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">bound</span> <span class="n">method</span> <span class="n">AbstractVersionedDataSet</span><span class="o">.</span><span class="n">load</span> <span class="n">of</span> <span class="o">&lt;</span><span class="n">kedro</span><span class="o">.</span><span class="n">extras</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pandas</span><span class="o">.</span><span class="n">parquet_dataset</span><span class="o">.</span><span class="n">ParquetDataSet</span> <span class="nb">object</span> <span class="n">at</span> <span class="mh">0x7f4bb15709a0</span><span class="o">&gt;&gt;</span><span class="p">}</span>
</code></pre></div>
<h2 id="incremental-vs-partitioned">incremental vs. partitioned</h2>
<p><code>IncrementalDataSet</code> 's and <code>PartitionedDataSet</code> 's are very similar as they give
you access to a whole directory of data that uses the same underlying dataset
loader.  The significant difference is whether you want your data pre-loaded or if
you want to load and dispose of it as you iterate over it.</p>
<ul>
<li>incremental loads the data</li>
<li>partitioned give a load function</li>
</ul>
<h2 id="creating-nodes-with-partitioned-datasets">creating nodes with partitioned datasets</h2>
<p>Let's create a node with this <code>PartitionedDataSet</code> to collect stats on our
dataset over time.  This node does a dict comprehension to get the length of
each version that we pulled.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">timeseries_partitioned</span><span class="p">(</span><span class="n">cars</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">car</span><span class="p">())</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">car</span> <span class="ow">in</span> <span class="n">cars</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">node</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">timeseries_partitioned</span><span class="p">,</span>
            <span class="n">inputs</span><span class="o">=</span><span class="s1">'int_cars_partitioned'</span><span class="p">,</span>
            <span class="n">outputs</span><span class="o">=</span><span class="s1">'int_cars_timeseries_partitioned'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'create_int_cars_timeseries_partitioned'</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
<blockquote>
<p>üóíÔ∏è note that inside of the dict comprehension car is a load function that we need to call.</p>
</blockquote>
<h2 id="creating-nodes-with-incremental-datasets">creating nodes with incremental datasets</h2>
<p>Doing the same node with our <code>IncrementalDataSet</code> looks very similar, except
this time car is loaded data inside of the dict comprehension, not a function
that we need to call.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">timeseries_incremental</span><span class="p">(</span><span class="n">cars</span><span class="p">:</span> <span class="n">Dict</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">car</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">car</span> <span class="ow">in</span> <span class="n">cars</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>

<span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">node</span><span class="p">(</span>
            <span class="n">func</span><span class="o">=</span><span class="n">timeseries_incremental</span><span class="p">,</span>
            <span class="n">inputs</span><span class="o">=</span><span class="s1">'int_cars_incremental'</span><span class="p">,</span>
            <span class="n">outputs</span><span class="o">=</span><span class="s1">'int_cars_timeseries_incremental'</span><span class="p">,</span>
            <span class="n">name</span><span class="o">=</span><span class="s1">'create_int_cars_timeseries_incremental'</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>
</code></pre></div>
<h2 id="more-catalog-entries">More catalog entries</h2>
<p>After adding those nodes, we can add the catalog entries again with the command
line.  This will not overwrite any of the datasets we just created. It will only
add to it.</p>
<div class="highlight"><pre><span></span><code>kedro catalog create --pipeline cars_nodes
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">int_cars_timeseries_partitioned</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MemoryDataSet</span><span class="w"></span>
<span class="nt">int_cars_timeseries_incremental</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MemoryDataSet</span><span class="w"></span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nt">int_cars_timeseries_partitioned</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pickle.PickleDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/int_cars_timeseries_partitioned.parquet</span><span class="w"></span>
<span class="nt">int_cars_timeseries_incremental</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pickle.PickleDataSet</span><span class="w"></span>
<span class="w">  </span><span class="nt">filepath</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">data/int_cars_timeseries_incremental.parquet</span><span class="w"></span>
</code></pre></div>
<h2 id="loading-the-new-datasets">Loading the new datasets</h2>
<p>Loading the two dtasets that we just created show that we have the ended up
with the same result using both incremental and partitioned datasets.  This
result is a dictionary of filepaths mapped to the size of the dataset.  Since
the default filepaths are timestamps we could start doing some time series
analysis to see how our dataset is changing over time.</p>
<div class="highlight"><pre><span></span><code><span class="n">In</span> <span class="p">[</span><span class="mi">32</span><span class="p">]:</span> <span class="n">context</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'int_cars_timeseries_incremental'</span><span class="p">)</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">55</span><span class="p">,</span><span class="mi">014</span> <span class="o">-</span> <span class="n">kedro</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">Loading</span> <span class="n">data</span> <span class="kn">from</span> <span class="err">`</span><span class="n">int_cars_timeseries_incremental</span><span class="err">`</span> <span class="p">(</span><span class="n">PickleDataSet</span><span class="p">)</span><span class="o">...</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">32</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">'2021-07-05T15.29.56.144Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.23.101Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.26.555Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.31.12.688Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T16.43.43.088Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">33</span><span class="p">]:</span> <span class="n">context</span><span class="o">.</span><span class="n">catalog</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'int_cars_timeseries_partitioned'</span><span class="p">)</span>
<span class="mi">2021</span><span class="o">-</span><span class="mi">07</span><span class="o">-</span><span class="mi">05</span> <span class="mi">12</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">03</span><span class="p">,</span><span class="mi">223</span> <span class="o">-</span> <span class="n">kedro</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">data_catalog</span> <span class="o">-</span> <span class="n">INFO</span> <span class="o">-</span> <span class="n">Loading</span> <span class="n">data</span> <span class="kn">from</span> <span class="err">`</span><span class="n">int_cars_timeseries_partitioned</span><span class="err">`</span> <span class="p">(</span><span class="n">PickleDataSet</span><span class="p">)</span><span class="o">...</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">33</span><span class="p">]:</span>
<span class="p">{</span><span class="s1">'2021-07-05T15.29.56.144Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.23.101Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.30.26.555Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T15.31.12.688Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T16.43.43.088Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">,</span>
 <span class="s1">'2021-07-05T16.50.46.686Z/int_cars.parquet'</span><span class="p">:</span> <span class="mi">32</span><span class="p">}</span>
</code></pre></div>
<div class="onelinelink-wrapper">
<a class="onelinelink" href="https://waylonwalker.com/kedro-pickle/">
<amp-img height="500" layout="responsive" src="https://images.waylonwalker.com/kedro-pickle-og_250x140.png" width="500"></amp-img>
<p><strong>
 Kedro - My Data Is Not A Table
</strong></p>
</a>
</div>
<blockquote>
<p>‚òùÔ∏è I have a full article on creating datasets that are not tabular datasets
using pickle.</p>
</blockquote>
<h2 id="cross-posted-to-dev">cross posted to dev</h2>
<p>If you like this article give it some ‚ù§Ô∏èü¶Ñüè∑Ô∏è on dev <a href="https://dev.to/waylonwalker/incremental-versioned-datasets-in-kedro-3ajn">https://dev.to/waylonwalker/incremental-versioned-datasets-in-kedro-3ajn</a></p>
<hr/>
<p>This post was primarily built live on <a href="https://twitch.tv/waylonwalker">https://twitch.tv/waylonwalker</a>, give me a
follow and join in the live show if that is something that interests you.</p>
<div class="prevnext">

<a class="prev" href="/kedro-inputs">
<svg fill="none" height="50px" viewbox="0 0 24 24" width="50px" xmlns="http://www.w3.org/2000/svg">
<path d="M13.5 8.25L9.75 12L13.5 15.75" stroke="var(--prevnext-color-angle)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> </path>
</svg>
<div class="prevnext-text">
<p class="prevnext-subtitle">prev</p>
<p class="prevnext-title">How Kedro handles your inputs</p>
</div>
</a>
<a class="next" href="/kedro-in-scripts">
<div class="prevnext-text">
<p class="prevnext-subtitle">next</p>
<p class="prevnext-title">Using Kedro In Scripts</p>
</div>
<svg fill="none" height="50px" viewbox="0 0 24 24" width="50px" xmlns="http://www.w3.org/2000/svg">
<path d="M10.5 15.75L14.25 12L10.5 8.25" stroke="var(--prevnext-color-angle)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></path>
</svg>
</a>
</div>
</div>
<hr/>
<div id="show">
</div>
</article>
<h2>Socials</h2>
<ul class="social">
<li>
<a href="https://twitter.com/_WaylonWalker">twitter</a>
</li>
<li>
<a href="https://www.linkedin.com/in/waylonwalker/">LinkedIn</a>
</li>
<li>
<a href="https://github.com/WaylonWalker">GitHub</a>
</li>
<li>
<a href="https://dev.to/waylonwalker">Dev.to</a>
</li>
<li>
<a href="https://www.twitch.tv/waylonwalker">twitch</a>
</li>
</ul>
</body>
</html>